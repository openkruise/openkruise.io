"use strict";(self.webpackChunkopenkruise_io=self.webpackChunkopenkruise_io||[]).push([[6803],{28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var r=s(96540);const d={},t=r.createContext(d);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),r.createElement(t.Provider,{value:n},e.children)}},40023:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"installation","title":"Installation","description":"Versioning and Compatibility","source":"@site/docs/installation.md","sourceDirName":".","slug":"/installation","permalink":"/docs/next/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/openkruise/openkruise.io/edit/master/docs/installation.md","tags":[],"version":"current","lastUpdatedBy":"Zhen Zhang","lastUpdatedAt":1751870499000,"frontMatter":{"title":"Installation"},"sidebar":"docs","previous":{"title":"Introduction","permalink":"/docs/next/"},"next":{"title":"Architecture","permalink":"/docs/next/core-concepts/architecture"}}');var d=s(74848),t=s(28453);const i={title:"Installation"},l=void 0,c={},a=[{value:"Versioning and Compatibility",id:"versioning-and-compatibility",level:2},{value:"Install with helm",id:"install-with-helm",level:2},{value:"Upgrade with helm",id:"upgrade-with-helm",level:2},{value:"Optional: download charts manually",id:"optional-download-charts-manually",level:2},{value:"Options",id:"options",level:2},{value:"Optional: chart parameters",id:"optional-chart-parameters",level:3},{value:"setup parameters",id:"setup-parameters",level:4},{value:"manager parameters",id:"manager-parameters",level:4},{value:"daemon parameters",id:"daemon-parameters",level:4},{value:"other parameters",id:"other-parameters",level:4},{value:"Optional: feature-gate",id:"optional-feature-gate",level:3},{value:"Optional: the local image for China",id:"optional-the-local-image-for-china",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Installation parameters for K3s",id:"installation-parameters-for-k3s",level:3},{value:"Installation parameters for AWS EKS",id:"installation-parameters-for-aws-eks",level:3},{value:"Support webhook CA injection using external certification management tool",id:"support-webhook-ca-injection-using-external-certification-management-tool",level:3},{value:"Structured Logs",id:"structured-logs",level:3},{value:"Versioning and Compatibility",id:"versioning-and-compatibility-1",level:2},{value:"Uninstall",id:"uninstall",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h2,{id:"versioning-and-compatibility",children:"Versioning and Compatibility"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Kruise Version"}),(0,d.jsx)(n.th,{children:"1.18"}),(0,d.jsx)(n.th,{children:"1.20"}),(0,d.jsx)(n.th,{children:"1.22"}),(0,d.jsx)(n.th,{children:"1.24"}),(0,d.jsx)(n.th,{children:"1.26"}),(0,d.jsx)(n.th,{children:"1.28"}),(0,d.jsx)(n.th,{children:"1.30"}),(0,d.jsx)(n.th,{children:"1.32"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.4.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.5.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.6.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.7.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.8.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"HEAD"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Key:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u2713: Exactly the same API objects/fields in both Kruise and the Kubernetes version."}),"\n",(0,d.jsx)(n.li,{children:"+: Kruise has api objects/fields that may not be present in the Kubernetes cluster, but everything they have in common will work."}),"\n",(0,d.jsx)(n.li,{children:"-: The Kubernetes cluster has features the Kruise can't use (additional API objects and fields, etc)."}),"\n",(0,d.jsx)(n.li,{children:"?: It is not tested against the Kubernetes cluster."}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Here is some important notes about the compatibility between Kruise and Kubernetes:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Since v1.0.0 (alpha/beta), OpenKruise requires ",(0,d.jsx)(n.strong,{children:"Kubernetes version >= 1.16"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Since v1.5.0(alpha/beta), OpenKruise no longer supports dockershim. If you still use Docker Engine to run containers\nin Kubernetes,\nyou\ncan ",(0,d.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/migrating-from-dockershim/migrate-dockershim-dockerd/",children:"Migrate Docker Engine nodes from dockershim to cri-dockerd."})]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Since v1.6.0 (alpha/beta), OpenKruise requires ",(0,d.jsx)(n.strong,{children:"Kubernetes version >= 1.18"}),'. However it\'s still possible to use\nOpenKruise with Kubernetes versions 1.16 and 1.17 as long as KruiseDaemon is not enabled(install/upgrade kruise charts\nwith featureGates="KruiseDaemon=false")']}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Since v1.6.0 (alpha/beta), KruiseDaemon will ",(0,d.jsx)(n.strong,{children:"no longer support v1alpha2 CRI runtimes"}),'. However, it is still\npossible to use OpenKruise on Kubernetes clusters with nodes that only support v1alpha2 CRI, as long as KruiseDaemon\nis not enabled (install/upgrade Kruise charts with featureGates="KruiseDaemon=false").']}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"Since 1.7.3, Kruise installed via Helm will automatically detect the existence of Kruise CRs during uninstallation\nusing a pre-delete hook. If any CRs exist, the uninstall process will be blocked to prevent accidental deletion of CRs\nbeyond the user's expectation."}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"install-with-helm",children:"Install with helm"}),"\n",(0,d.jsxs)(n.p,{children:["Kruise can be simply installed by helm v3.5+, which is a simple command-line tool and you can get it\nfrom ",(0,d.jsx)(n.a,{href:"https://github.com/helm/helm/releases",children:"here"}),"."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Firstly add openkruise charts repository if you haven't do this.\n$ helm repo add openkruise https://openkruise.github.io/charts/\n\n# [Optional]\n$ helm repo update\n\n# Install the latest version.\n$ helm install kruise openkruise/kruise --version 1.8.0\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Note:"})," ",(0,d.jsx)(n.a,{href:"https://github.com/openkruise/kruise/blob/master/CHANGELOG.md",children:"Changelog"}),"."]}),"\n",(0,d.jsx)(n.h2,{id:"upgrade-with-helm",children:"Upgrade with helm"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Firstly add openkruise charts repository if you haven't do this.\n$ helm repo add openkruise https://openkruise.github.io/charts/\n\n# [Optional]\n$ helm repo update\n\n# Upgrade to the latest version.\n$ helm upgrade kruise openkruise/kruise --version 1.8.0 [--force]\n"})}),"\n",(0,d.jsx)(n.p,{children:"Note that:"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["Before upgrade, you ",(0,d.jsx)(n.strong,{children:"must"})," firstly read\nthe ",(0,d.jsx)(n.a,{href:"https://github.com/openkruise/kruise/blob/master/CHANGELOG.md",children:"Change Log"}),"\nto make sure that you have understand the breaking changes in the new version."]}),"\n",(0,d.jsxs)(n.li,{children:["If you want to drop the chart parameters you configured for the old release or set some new parameters,\nit is recommended to add ",(0,d.jsx)(n.code,{children:"--reset-values"})," flag in ",(0,d.jsx)(n.code,{children:"helm upgrade"})," command.\nOtherwise you should use ",(0,d.jsx)(n.code,{children:"--reuse-values"})," flag to reuse the last release's values."]}),"\n",(0,d.jsxs)(n.li,{children:["If you are ",(0,d.jsx)(n.strong,{children:"upgrading Kruise from 0.x to 1.x"}),", you must add ",(0,d.jsx)(n.code,{children:"--force"})," for upgrade command. Otherwise it is an\noptional flag."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"optional-download-charts-manually",children:"Optional: download charts manually"}),"\n",(0,d.jsxs)(n.p,{children:["If you have problem with connecting to ",(0,d.jsx)(n.code,{children:"https://openkruise.github.io/charts/"})," in production, you might need to download\nthe chart from ",(0,d.jsx)(n.a,{href:"https://github.com/openkruise/charts/releases",children:"here"})," manually and install or upgrade with it."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"$ helm install/upgrade kruise /PATH/TO/CHART\n"})}),"\n",(0,d.jsx)(n.h2,{id:"options",children:"Options"}),"\n",(0,d.jsx)(n.p,{children:"Note that installing this chart directly means it will use the default template values for Kruise."}),"\n",(0,d.jsx)(n.p,{children:"You may have to set your specific configurations if it is deployed into a production cluster, or you want to configure\nfeature-gates."}),"\n",(0,d.jsx)(n.h3,{id:"optional-chart-parameters",children:"Optional: chart parameters"}),"\n",(0,d.jsx)(n.p,{children:"The following table lists the configurable parameters of the chart and their default values."}),"\n",(0,d.jsx)(n.h4,{id:"setup-parameters",children:"setup parameters"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Parameter"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Default"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"featureGates"})}),(0,d.jsx)(n.td,{children:"Feature gates for Kruise, empty string means all enabled"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:'""'})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"installation.namespace"})}),(0,d.jsx)(n.td,{children:"Namespace for kruise installation"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"kruise-system"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"installation.createNamespace"})}),(0,d.jsx)(n.td,{children:"Whether to create the installation.namespace"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"installation.roleListGroups"})}),(0,d.jsx)(n.td,{children:"ApiGroups which kruise is permit to list, default set to be all"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"*"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"crds.managed"})}),(0,d.jsx)(n.td,{children:"Kruise will not install CRDs with chart if this is false"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"imagePullSecrets"})}),(0,d.jsx)(n.td,{children:"The list of image pull secrets for kruise image"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"[]"})})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"manager-parameters",children:"manager parameters"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Parameter"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Default"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.log.level"})}),(0,d.jsx)(n.td,{children:"Log level that kruise-manager printed"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"4"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.replicas"})}),(0,d.jsx)(n.td,{children:"Replicas of kruise-controller-manager deployment"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"2"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.image.repository"})}),(0,d.jsx)(n.td,{children:"Repository for kruise-manager image"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"openkruise/kruise-manager"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.image.tag"})}),(0,d.jsx)(n.td,{children:"Tag for kruise-manager image"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"v1.8.0"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.resources.limits.cpu"})}),(0,d.jsx)(n.td,{children:"CPU resource limit of kruise-manager container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"200m"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.resources.limits.memory"})}),(0,d.jsx)(n.td,{children:"Memory resource limit of kruise-manager container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"512Mi"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.resources.requests.cpu"})}),(0,d.jsx)(n.td,{children:"CPU resource request of kruise-manager container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"100m"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.resources.requests.memory"})}),(0,d.jsx)(n.td,{children:"Memory resource request of kruise-manager container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"256Mi"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.metrics.port"})}),(0,d.jsx)(n.td,{children:"Port of metrics served"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"8080"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.webhook.port"})}),(0,d.jsx)(n.td,{children:"Port of webhook served"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"9443"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.pprofAddr"})}),(0,d.jsx)(n.td,{children:"Address of pprof served"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"localhost:8090"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.nodeAffinity"})}),(0,d.jsx)(n.td,{children:"Node affinity policy for kruise-manager pod"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{}"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.nodeSelector"})}),(0,d.jsx)(n.td,{children:"Node labels for kruise-manager pod"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{}"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.tolerations"})}),(0,d.jsx)(n.td,{children:"Tolerations for kruise-manager pod"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"[]"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.resyncPeriod"})}),(0,d.jsx)(n.td,{children:"Resync period of informer kruise-manager, defaults no resync"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.hostNetwork"})}),(0,d.jsx)(n.td,{children:"Whether kruise-manager pod should run with hostnetwork"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"manager.loggingFormat"})}),(0,d.jsxs)(n.td,{children:["Logging format, valid formats includes ",(0,d.jsx)(n.code,{children:" "}),"(plain text), ",(0,d.jsx)(n.code,{children:"json"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:" "})})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"daemon-parameters",children:"daemon parameters"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Parameter"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Default"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.extraEnvs"})}),(0,d.jsx)(n.td,{children:"Extra environment variables that will be pass onto pods"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"[]"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.log.level"})}),(0,d.jsx)(n.td,{children:"Log level that kruise-daemon printed"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"4"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.port"})}),(0,d.jsx)(n.td,{children:"Port of metrics and healthz that kruise-daemon served"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"10221"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.pprofAddr"})}),(0,d.jsx)(n.td,{children:"Address of pprof served"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"localhost:10222"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.resources.limits.cpu"})}),(0,d.jsx)(n.td,{children:"CPU resource limit of kruise-daemon container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"50m"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.resources.limits.memory"})}),(0,d.jsx)(n.td,{children:"Memory resource limit of kruise-daemon container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"128Mi"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.resources.requests.cpu"})}),(0,d.jsx)(n.td,{children:"CPU resource request of kruise-daemon container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.resources.requests.memory"})}),(0,d.jsx)(n.td,{children:"Memory resource request of kruise-daemon container"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.affinity"})}),(0,d.jsx)(n.td,{children:"Affinity policy for kruise-daemon pod"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{}"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.socketLocation"})}),(0,d.jsx)(n.td,{children:"Location of the container manager control socket"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"/var/run"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.socketFile"})}),(0,d.jsxs)(n.td,{children:["Specify the socket file name in ",(0,d.jsx)(n.code,{children:"socketLocation"})," (if you are not using containerd/docker/pouch/cri-o)"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:" "})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.credentialProvider.enable"})}),(0,d.jsx)(n.td,{children:"Whether to enable credential provider for image pull job"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.credentialProvider.hostPath"})}),(0,d.jsx)(n.td,{children:"node dir of the credential provider plugin, kruise-daemon will mount the dir as a hostpath volume"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"credential-provider-plugin"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.credentialProvider.configmap"})}),(0,d.jsx)(n.td,{children:"configmap name of the credential provider in kruise-system ns"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"credential-provider-config"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"daemon.credentialProvider.awsCredentialsDir"})}),(0,d.jsxs)(n.td,{children:["aws credentials dir if using AWS, for example: ",(0,d.jsx)(n.code,{children:"/root/.aws"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:" "})})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"other-parameters",children:"other parameters"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Parameter"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Default"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"enableKubeCacheMutationDetector"})}),(0,d.jsx)(n.td,{children:"Whether to enable KUBE_CACHE_MUTATION_DETECTOR"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"webhookConfiguration.timeoutSeconds"})}),(0,d.jsx)(n.td,{children:"The timeoutSeconds for all webhook configuration"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"30"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"serviceAccount.annotations"})}),(0,d.jsx)(n.td,{children:"Annotations to patch for serviceAccounts"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{}"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"externalCerts.annotations"})}),(0,d.jsxs)(n.td,{children:["Annotations to patch for webhook configuration and crd when featuregate ",(0,d.jsx)(n.code,{children:"EnableExternalCerts"})," is enabled. For example, ",(0,d.jsx)(n.code,{children:"cert-manager.io/inject-ca-from: kruise-system/kruise-webhook-certs"}),"."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{}"})})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:["Specify each parameter using the ",(0,d.jsx)(n.code,{children:"--set key=value[,key=value]"})," argument to ",(0,d.jsx)(n.code,{children:"helm install"})," or ",(0,d.jsx)(n.code,{children:"helm upgrade"}),"."]}),"\n",(0,d.jsx)(n.h3,{id:"optional-feature-gate",children:"Optional: feature-gate"}),"\n",(0,d.jsx)(n.p,{children:"Feature-gate controls some influential features in Kruise:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Name"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Default"}),(0,d.jsx)(n.th,{children:"Effect (if closed)"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PodWebhook"})}),(0,d.jsxs)(n.td,{children:["Whether to open a webhook for Pod ",(0,d.jsx)(n.strong,{children:"create"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"SidecarSet/KruisePodReadinessGate disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"KruiseDaemon"})}),(0,d.jsxs)(n.td,{children:["Whether to deploy ",(0,d.jsx)(n.code,{children:"kruise-daemon"})," DaemonSet"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"ImagePulling/ContainerRecreateRequest disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"DaemonWatchingPod"})}),(0,d.jsxs)(n.td,{children:["Should each ",(0,d.jsx)(n.code,{children:"kruise-daemon"})," watch pods on the same node"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"For in-place update with same imageID or env from labels/annotations"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"CloneSetShortHash"})}),(0,d.jsx)(n.td,{children:"Enables CloneSet controller only set revision hash name to pod label"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"CloneSet name can not be longer than 54 characters"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"KruisePodReadinessGate"})}),(0,d.jsx)(n.td,{children:"Enables Kruise webhook to inject 'KruisePodReady' readiness-gate to all Pods during creation"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"The readiness-gate will only be injected to Pods created by Kruise workloads"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PreDownloadImageForInPlaceUpdate"})}),(0,d.jsx)(n.td,{children:"Enables CloneSet controller to create ImagePullJobs to pre-download images for in-place update"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"No image pre-download for in-place update"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"CloneSetPartitionRollback"})}),(0,d.jsx)(n.td,{children:"Enables CloneSet controller to rollback Pods to currentRevision when number of updateRevision pods is bigger than (replicas - partition)"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"CloneSet will only update Pods to updateRevision"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ResourcesDeletionProtection"})}),(0,d.jsx)(n.td,{children:"Enables protection for resources deletion"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"No protection for resources deletion"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"TemplateNoDefaults"})}),(0,d.jsx)(n.td,{children:"Whether to disable defaults injection for pod/pvc template in workloads"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Should not close this feature if it has open"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PodUnavailableBudgetDeleteGate"})}),(0,d.jsx)(n.td,{children:"Enables PodUnavailableBudget for pod deletion, eviction"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"No protection for pod deletion, eviction"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PodUnavailableBudgetUpdateGate"})}),(0,d.jsx)(n.td,{children:"Enables PodUnavailableBudget for pod.Spec update"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"No protection for in-place update"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"WorkloadSpread"})}),(0,d.jsx)(n.td,{children:"Enables WorkloadSpread to manage multi-domain and elastic deploy"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"WorkloadSpread disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"InPlaceUpdateEnvFromMetadata"})}),(0,d.jsx)(n.td,{children:"Enables Kruise to in-place update a container in Pod when its env from labels/annotations changed and pod is in-place updating"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"Only container image can be in-place update"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"StatefulSetAutoDeletePVC"})}),(0,d.jsx)(n.td,{children:"Enables policies controlling deletion of PVCs created by a StatefulSet"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"No deletion of PVCs by StatefulSet"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PreDownloadImageForDaemonSetUpdate"})}),(0,d.jsx)(n.td,{children:"Enables DaemonSet controller to create ImagePullJobs to pre-download images for in-place update"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"No image pre-download for in-place update"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PodProbeMarkerGate"})}),(0,d.jsx)(n.td,{children:"Whether to turn on PodProbeMarker ability"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"PodProbeMarker disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SidecarSetPatchPodMetadataDefaultsAllowed"})}),(0,d.jsx)(n.td,{children:"Allow SidecarSet patch any annotations to Pod Object"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Annotations are not allowed to patch randomly and need to be configured via SidecarSet_PatchPodMetadata_WhiteList"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SidecarTerminator"})}),(0,d.jsx)(n.td,{children:"SidecarTerminator enables SidecarTerminator to stop sidecar containers when all main containers exited"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"SidecarTerminator disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"CloneSetEventHandlerOptimization"})}),(0,d.jsx)(n.td,{children:"CloneSetEventHandlerOptimization enable optimization for cloneset-controller to reduce the queuing frequency cased by pod update"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"optimization for cloneset-controller to reduce the queuing frequency cased by pod update disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ImagePullJobGate"})}),(0,d.jsx)(n.td,{children:"Enables ImagePullJob to pre-download images"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"ImagePullJob disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ResourceDistributionGate"})}),(0,d.jsx)(n.td,{children:"Enables ResourceDistribution to distribute configmaps or secret resources"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"ResourceDistribution disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"DeletionProtectionForCRDCascadingGate"})}),(0,d.jsx)(n.td,{children:"Enables DeletionProtection for crd cascading deletion"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"DeletionProtection for crd cascading deletion disabled"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PreparingUpdateAsUpdate"})}),(0,d.jsx)(n.td,{children:"When enabled, pods in the PreparingUpdate phase are considered updated instances during scaling operations"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Pods in the PreparingUpdate phase are still considered current version instances during scaling operations"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"EnhancedLivenessProbeGate"})}),(0,d.jsx)(n.td,{children:"Enables an enhanced liveness probe solution"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"RecreatePodWhenChangeVCTInCloneSetGate"})}),(0,d.jsx)(n.td,{children:"Enables automatic pod recreation for PVC resizing when volumeClaimTemplates are changed in CloneSet"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"StatefulSetStartOrdinal"})}),(0,d.jsx)(n.td,{children:"Allows users to specify the start ordinal for Advanced StatefulSet"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Unable to specify the start ordinal for Advanced StatefulSet"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PodIndexLabel"})}),(0,d.jsx)(n.td,{children:"Adds an index label to Advanced StatefulSet pods"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:"No longer adds an index label to Advanced StatefulSet pods"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"EnableExternalCerts"})}),(0,d.jsx)(n.td,{children:"Enables external certificate management functionality"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"StatefulSetAutoResizePVCGate"})}),(0,d.jsx)(n.td,{children:"Enables automatic resizing of PVCs for Advanced StatefulSet"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"VolumeClaimTemplates in Advanced StatefulSet only apply to newly created PVCs"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ForceDeleteTimeoutExpectationFeatureGate"})}),(0,d.jsx)(n.td,{children:"Forces cleanup of expectations that remain inconsistent after a certain period"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Will keep waiting until cache and expectation are consistent"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"InPlaceWorkloadVerticalScaling"})}),(0,d.jsx)(n.td,{children:"Enables in-place resource scaling support for workloads, allowing resource changes without pod recreation"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Modifying resources in the workload will trigger pod recreation"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"EnablePodProbeMarkerOnServerless"})}),(0,d.jsx)(n.td,{children:"Enables PodProbeMarker support for serverless pods"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:"Does not support PodProbeMarker for serverless pods"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"If you want to configure the feature-gate, just set the parameter when install or upgrade. Such as:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'$ helm install kruise https://... --set featureGates="ResourcesDeletionProtection=true\\,PreDownloadImageForInPlaceUpdate=true"\n'})}),"\n",(0,d.jsxs)(n.p,{children:["If you want to enable all feature-gates, set the parameter as ",(0,d.jsx)(n.code,{children:"featureGates=AllAlpha=true"}),"."]}),"\n",(0,d.jsx)(n.h3,{id:"optional-the-local-image-for-china",children:"Optional: the local image for China"}),"\n",(0,d.jsx)(n.p,{children:"If you are in China and have problem to pull image from official DockerHub, you can use the registry hosted on Alibaba\nCloud:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"$ helm install kruise https://... --set  manager.image.repository=openkruise-registry.cn-shanghai.cr.aliyuncs.com/openkruise/kruise-manager\n"})}),"\n",(0,d.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,d.jsx)(n.h3,{id:"installation-parameters-for-k3s",children:"Installation parameters for K3s"}),"\n",(0,d.jsxs)(n.p,{children:["Usually K3s has the different runtime path from the default ",(0,d.jsx)(n.code,{children:"/var/run"}),". So you have to set ",(0,d.jsx)(n.code,{children:"daemon.socketLocation"})," to\nthe real runtime socket path on your K3s node (e.g. ",(0,d.jsx)(n.code,{children:"/run/k3s"})," or ",(0,d.jsx)(n.code,{children:"/var/run/k3s/"}),")."]}),"\n",(0,d.jsx)(n.h3,{id:"installation-parameters-for-aws-eks",children:"Installation parameters for AWS EKS"}),"\n",(0,d.jsx)(n.p,{children:"When using a custom CNI (such as Weave or Calico) on EKS, the webhook cannot be reached by default. This happens because\nthe control plane cannot be configured to run on a custom CNI on EKS, so the CNIs differ between control plane and\nworker nodes."}),"\n",(0,d.jsxs)(n.p,{children:["To address this, the webhook can be run in the host network so it can be reached, by setting\n",(0,d.jsx)(n.code,{children:"--set manager.hostNetwork=true"})," when use helm install or upgrade."]}),"\n",(0,d.jsx)(n.h3,{id:"support-webhook-ca-injection-using-external-certification-management-tool",children:"Support webhook CA injection using external certification management tool"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"FEATURE STATE:"})," Kruise v1.7.0"]}),"\n",(0,d.jsx)(n.p,{children:"Kruise needs certificates to enable mutating, validating and conversion webhooks. By default, kruise will generate\nself-signed certificates for webhook server.\nIf you want to use external certification management tool, e.g. cert-manager, you can follow these steps when install or\nupgrade:"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["Install external certification management tool, e.g. ",(0,d.jsx)(n.a,{href:"https://cert-manager.io/docs/installation/helm/",children:"cert-manager"}),"."]}),"\n",(0,d.jsx)(n.li,{children:"Create issuer and certificate resources if you have not done this before."}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: kruise-webhook-certs\n  # consistent with installation.namespace\n  namespace: kruise-system\nspec:\n  # where to store the certificates\n  # cert-manager would generate a secret kruise-system/kruise-webhook-certs with the certificates\n  # DO NOT CHANGE THE SECRET NAME SINCE KRUISE READ CERTS FROM THIS SECRET\n  secretName: kruise-webhook-certs\n  dnsNames:\n  - kruise-webhook-service.kruise-system.svc\n  - localhost\n  issuerRef:\n    name: selfsigned-kruise\n    kind: Issuer\n---\napiVersion: cert-manager.io/v1\nkind: Issuer\nmetadata:\n  name: selfsigned-kruise\n  namespace: kruise-system\nspec:\n  selfSigned: {}\n"})}),"\n",(0,d.jsxs)(n.ol,{start:"3",children:["\n",(0,d.jsx)(n.li,{children:"During installation and upgrade, enable external certs support by setting featureGates=EnableExternalCerts=true and\nspecify extra annotations that should be added to webhookconfiguration and CRD."}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'helm install kruise https://... --set featureGates="EnableExternalCerts=true" --set-json externalCerts.annotations=\'{"cert-manager.io/inject-ca-from":"kruise-system/kruise-webhook-certs"}\'\n'})}),"\n",(0,d.jsxs)(n.p,{children:["Visit ",(0,d.jsx)(n.a,{href:"https://cert-manager.io/docs/concepts/ca-injector/",children:"CA Injector - cert manager"})," for more details."]}),"\n",(0,d.jsx)(n.h3,{id:"structured-logs",children:"Structured Logs"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"FEATURE STATE:"})," Kruise v1.7.0"]}),"\n",(0,d.jsx)(n.p,{children:"Logs are an essential aspect of observability and a critical tool for debugging. But OpenKruise logs have traditionally\nbeen unstructured strings, making any automated parsing difficult and any downstream processing, analysis, or querying\nchallenging to do reliably."}),"\n",(0,d.jsxs)(n.p,{children:["From OpenKruise 1.7, we are adding support for structured logs, which natively support (key, value) pairs and object\nreferences.\nAnd logs can also be outputted in JSON format using ",(0,d.jsx)(n.code,{children:"helm install ... --set manager.loggingFormat=json"}),"."]}),"\n",(0,d.jsx)(n.p,{children:"For example, this invocation of InfoS:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'klog.V(3).InfoS("SidecarSet updated status success", "sidecarSet", klog.KObj(sidecarSet), "matchedPods", status.MatchedPods,\n"updatedPods", status.UpdatedPods, "readyPods", status.ReadyPods, "updateReadyPods", status.UpdatedReadyPods)\n'})}),"\n",(0,d.jsx)(n.p,{children:"will result in this log:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'I0821 14:22:35.587919       1 sidecarset_processor.go:280] "SidecarSet updated status success" sidecarSet="test-sidecarset" matchedPods=1 updatedPods=1 readyPods=1 updateReadyPods=1\n'})}),"\n",(0,d.jsxs)(n.p,{children:["Or, if ",(0,d.jsx)(n.code,{children:"helm install ... --set manager.loggingFormat=json"}),", it will result in this output:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "ts": 1724239224606.642,\n  "caller": "sidecarset/sidecarset_processor.go:280",\n  "msg": "SidecarSet updated status success",\n  "v": 3,\n  "sidecarSet": {\n    "name": "test-sidecarset"\n  },\n  "matchedPods": 1,\n  "updatedPods": 1,\n  "readyPods": 0,\n  "updateReadyPods": 0\n}\n'})}),"\n",(0,d.jsx)(n.h2,{id:"versioning-and-compatibility-1",children:"Versioning and Compatibility"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Kruise Version"}),(0,d.jsx)(n.th,{children:"1.18"}),(0,d.jsx)(n.th,{children:"1.20"}),(0,d.jsx)(n.th,{children:"1.22"}),(0,d.jsx)(n.th,{children:"1.24"}),(0,d.jsx)(n.th,{children:"1.26"}),(0,d.jsx)(n.th,{children:"1.28"}),(0,d.jsx)(n.th,{children:"1.30"}),(0,d.jsx)(n.th,{children:"1.32"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.4.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.5.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.6.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.7.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1.8.x"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"}),(0,d.jsx)(n.td,{children:"?"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"HEAD"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"?"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"+"}),(0,d.jsx)(n.td,{children:"\u2713"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Key:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u2713: Exactly the same API objects/fields in both Kruise and the Kubernetes version."}),"\n",(0,d.jsx)(n.li,{children:"+: Kruise has api objects/fields that may not be present in the Kubernetes cluster, but everything they have in common will work."}),"\n",(0,d.jsx)(n.li,{children:"-: The Kubernetes cluster has features the Kruise can't use (additional API objects and fields, etc)."}),"\n",(0,d.jsx)(n.li,{children:"?: It is not tested against the Kubernetes cluster."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"uninstall",children:"Uninstall"}),"\n",(0,d.jsx)(n.p,{children:"Note that this will lead to all resources created by Kruise, including webhook configurations, services, namespace,\nCRDs, CR instances and Pods managed by Kruise controller, to be deleted!"}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsx)(n.p,{children:"Since 1.7.3, Kruise installed via Helm will automatically detect the existence of Kruise CRs during uninstallation\nusing a pre-delete hook. If any CRs exist, the uninstall process will be blocked. You need to manually clean up the\nKruise CRs before you can uninstall Kruise using the following steps."}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Please do this ONLY when you fully understand the consequence."}),"\n",(0,d.jsx)(n.p,{children:"To uninstall kruise if it is installed with helm charts:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'$ helm uninstall kruise\nrelease "kruise" uninstalled\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}}}]);