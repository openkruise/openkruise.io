"use strict";(globalThis.webpackChunkopenkruise_io=globalThis.webpackChunkopenkruise_io||[]).push([[1233],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var a=n(96540);const i={},s=a.createContext(i);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:t},e.children)}},31900:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>g,frontMatter:()=>r,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"best-practices/cert-manager","title":"Best Practice: Managing sandbox-manager Self-Signed Certificates with cert-manager","description":"This document provides a best practice for managing and deploying sandbox-manager self-signed certificates using","source":"@site/kruiseagents/best-practices/cert-manager.md","sourceDirName":"best-practices","slug":"/best-practices/cert-manager","permalink":"/kruiseagents/best-practices/cert-manager","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Ai Ranthem","lastUpdatedAt":1770373181000,"frontMatter":{},"sidebar":"kruiseagents","previous":{"title":"Best Practice: Accessing sandbox-manager via E2B Protocol with Self-Signed Certificates","permalink":"/kruiseagents/best-practices/use-self-signed-cert"},"next":{"title":"Contributing to OpenKruise Agents","permalink":"/kruiseagents/developer-manuals/contribution"}}');var i=n(74848),s=n(28453);const r={},c="Best Practice: Managing sandbox-manager Self-Signed Certificates with cert-manager",l={},o=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Install cert-manager",id:"step-1-install-cert-manager",level:2},{value:"Step 2: Automatic Certificate Management with cert-manager",id:"step-2-automatic-certificate-management-with-cert-manager",level:2},{value:"Step 3: Verify Certificate Status",id:"step-3-verify-certificate-status",level:2},{value:"Step 4: Configure Client Trust",id:"step-4-configure-client-trust",level:2},{value:"4.1 Obtain CA Certificate",id:"41-obtain-ca-certificate",level:3},{value:"4.2 Configure Client",id:"42-configure-client",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"best-practice-managing-sandbox-manager-self-signed-certificates-with-cert-manager",children:"Best Practice: Managing sandbox-manager Self-Signed Certificates with cert-manager"})}),"\n",(0,i.jsx)(t.p,{children:"This document provides a best practice for managing and deploying sandbox-manager self-signed certificates using\ncert-manager."}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"sandbox-manager is installed in the cluster"}),"\n",(0,i.jsx)(t.li,{children:"Ensure kubectl command-line tool is available with appropriate permissions"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"step-1-install-cert-manager",children:"Step 1: Install cert-manager"}),"\n",(0,i.jsxs)(t.p,{children:["If you haven't installed cert-manager yet, please refer to\nthe ",(0,i.jsx)(t.a,{href:"https://cert-manager.io/docs/installation/",children:"official documentation"})," for installation."]}),"\n",(0,i.jsx)(t.h2,{id:"step-2-automatic-certificate-management-with-cert-manager",children:"Step 2: Automatic Certificate Management with cert-manager"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:['Replace "*.your.domain.com" and "your.domain.com" in ',(0,i.jsx)(t.a,{href:"https://github.com/openkruise/agents/blob/master/docs/best-practices/cert-manager.yaml",children:"cert-manager.yaml"})," with your domain."]}),"\n",(0,i.jsxs)(t.li,{children:["Add the configuration to the Kubernetes cluster: ",(0,i.jsx)(t.code,{children:"kubectl apply -f cert-manager.yaml"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"step-3-verify-certificate-status",children:"Step 3: Verify Certificate Status"}),"\n",(0,i.jsx)(t.p,{children:"Check if certificates are created and issued correctly:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"kubectl get certificates -n sandbox-system\nkubectl describe certificate sandbox-manager-ingress-cert -n sandbox-system\nkubectl describe secret sandbox-manager-tls -n sandbox-system\n"})}),"\n",(0,i.jsx)(t.p,{children:"Check Ingress status:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"kubectl get ingress sandbox-manager -n sandbox-system\nkubectl describe ingress sandbox-manager -n sandbox-system\n"})}),"\n",(0,i.jsx)(t.h2,{id:"step-4-configure-client-trust",children:"Step 4: Configure Client Trust"}),"\n",(0,i.jsx)(t.p,{children:"Since you are using self-signed certificates, clients need to trust the root CA certificate."}),"\n",(0,i.jsx)(t.h3,{id:"41-obtain-ca-certificate",children:"4.1 Obtain CA Certificate"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"kubectl get secret sandbox-ca-key-pair -n sandbox-system -o jsonpath='{.data.tls\\.crt}' | base64 -d > ca.crt\n"})}),"\n",(0,i.jsx)(t.h3,{id:"42-configure-client",children:"4.2 Configure Client"}),"\n",(0,i.jsxs)(t.p,{children:["Clients need to set the environment variable ",(0,i.jsx)(t.code,{children:"SSL_CERT_FILE"})," to the path of the obtained CA certificate:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"export SSL_CERT_FILE=/path/to/ca.crt\n"})})]})}function g(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);